<div class="library">
  <div class="library__wrapper">
    <div class="library__grid">
      <!-- Left Column: Search & Results -->
      <div class="library__main">
        <!-- Page Header -->
        <div class="library__header">
          <h1 class="library__title">Search My Library</h1>
        </div>

        <!-- Search Bar -->
        <div class="library__search">
          <div class="search-bar">
            <span class="material-symbols-outlined search-bar__icon">search</span>
            <input
              type="text"
              class="search-bar__input"
              placeholder="Search papers by topic, keyword, or title..."
              [(ngModel)]="searchQuery"
              (keyup.enter)="searchPapers()"
            />
          </div>
        </div>

        <!-- Filters & Sort -->
        <div class="library__controls">
          <div class="filters">
            <button
              *ngFor="let filter of activeFilters"
              class="filter-tag"
              (click)="removeFilter(filter)"
            >
              <span>{{ filter }}</span>
              <span class="material-symbols-outlined filter-tag__close">close</span>
            </button>
            <button class="filter-tag filter-tag--add" (click)="addFilter()">
              <span class="material-symbols-outlined">add</span>
              <span>Add Filter</span>
            </button>
          </div>

          <div class="sort-control">
            <label class="sort-control__label" for="sort">Sort by:</label>
            <select
              id="sort"
              class="sort-control__select"
              [(ngModel)]="selectedSort"
            >
              <option *ngFor="let option of sortOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
        </div>

        <!-- Results Header -->
        <h2 class="library__results-title">Search Results</h2>

        <!-- Results List -->
        <div class="library__results">
          <div
            *ngFor="let result of searchResults"
            class="result-card"
            [class.result-card--selected]="result.isSelected"
            (click)="selectResult(result.id)"
          >
            <div class="result-card__header">
              <h3 class="result-card__title">{{ result.title }}</h3>
              <div class="match-badge" [ngClass]="getMatchColor(result.matchPercentage)">
                <span class="material-symbols-outlined">signal_cellular_alt</span>
                <span class="match-badge__text">{{ result.matchPercentage }}% Match</span>
              </div>
            </div>
            <p class="result-card__authors">{{ result.authors }} ({{ result.year }})</p>
            <p class="result-card__abstract">{{ result.abstract }}</p>
          </div>
        </div>
      </div>

      <!-- Right Column: Paper Details -->
      <aside class="library__sidebar">
        <div class="detail-panel">
          <div class="detail-panel__section">
            <h2 class="detail-panel__title">{{ selectedPaperDetail.title }}</h2>
            <p class="detail-panel__authors">{{ selectedPaperDetail.authors }}</p>
            <p class="detail-panel__institution">{{ selectedPaperDetail.institution }}</p>
          </div>

          <div class="detail-panel__section">
            <h4 class="detail-panel__section-title">ABSTRACT</h4>
            <p class="detail-panel__abstract">{{ selectedPaperDetail.abstract }}</p>
          </div>

          <div class="detail-panel__section">
            <h4 class="detail-panel__section-title">KEYWORDS</h4>
            <div class="keyword-tags">
              <span
                *ngFor="let keyword of selectedPaperDetail.keywords"
                class="keyword-tag"
              >
                {{ keyword }}
              </span>
            </div>
          </div>

          <div class="detail-panel__actions">
            <button class="detail-panel__button detail-panel__button--primary" (click)="viewPDF()">
              <span class="material-symbols-outlined">picture_as_pdf</span>
              <span>View PDF</span>
            </button>
            <button class="detail-panel__button detail-panel__button--secondary" (click)="copyCitation()">
              <span class="material-symbols-outlined">format_quote</span>
              <span>Copy Citation</span>
            </button>
            <button class="detail-panel__button detail-panel__button--secondary" (click)="addToCollection()">
              <span class="material-symbols-outlined">add_circle</span>
              <span>Add to Collection</span>
            </button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>