<div class="library">
  <div class="library__wrapper">
    <div class="library__grid">
      <!-- Left Column: Search & Results -->
      <div class="library__main">
        <!-- Page Header -->
        <div class="library__header">
          <h1 class="library__title">Search My Library</h1>
        </div>

        <!-- Search Bar -->
        <div class="library__search">
          <div class="search-bar">
            <span class="material-symbols-outlined search-bar__icon">search</span>
            <input
              type="text"
              class="search-bar__input"
              placeholder="Search papers by topic, keyword, or title..."
              [(ngModel)]="searchQuery"
              (keyup.enter)="searchPapers()"
            />
          </div>
        </div>

          <!-- Filters & Sort (Filters temporarily disabled) -->
          <div class="library__controls">
            <!-- <div class="filters"> ... </div> -->
            <div class="sort-control">
            <label class="sort-control__label" for="sort">Sort by:</label>
            <select
              id="sort"
              class="sort-control__select"
              [(ngModel)]="selectedSort"
            >
              <option *ngFor="let option of sortOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
        </div>

        <!-- Results Header -->
        <h2 class="library__results-title">Search Results</h2>

        <!-- Results List -->
        <div class="library__results">
          <div *ngIf="filteredPapers.length === 0" class="no-results">
            <p>No papers found in your library.</p>
          </div>

          <div
            *ngFor="let paper of filteredPapers"
            class="result-card"
            [class.result-card--selected]="selectedPaper?.id === paper.id"
            (click)="selectPaper(paper)"
          >
            <div class="result-card__header">
              <h3 class="result-card__title">{{ paper.title }}</h3>
            </div>
            <p class="result-card__authors">{{ paper.authors.join(', ') }} ({{ paper.published | date:'yyyy' }})</p>
            <p class="result-card__abstract">{{ paper.summary | slice:0:200 }}...</p>
          </div>
        </div>
      </div>

      <!-- Right Column: Paper Details -->
      <aside class="library__sidebar" *ngIf="selectedPaper">
        <div class="detail-panel">
          <div class="detail-panel__section">
            <h2 class="detail-panel__title">{{ selectedPaper.title }}</h2>
            <p class="detail-panel__authors">{{ selectedPaper.authors.join(', ') }}</p>
            <p class="detail-panel__institution">Published: {{ selectedPaper.published | date:'mediumDate' }}</p>
          </div>

          <div class="detail-panel__section">
            <h4 class="detail-panel__section-title">SUMMARY</h4>
            <p class="detail-panel__abstract">{{ selectedPaper.summary }}</p>
          </div>

          <div class="detail-panel__actions">
            <button class="detail-panel__button detail-panel__button--primary" (click)="viewSummary(selectedPaper.id)">
              <span class="material-symbols-outlined">analytics</span>
              <span>Analyze</span>
            </button>
            <button class="detail-panel__button detail-panel__button--secondary" (click)="chatWithPaper(selectedPaper.id)">
              <span class="material-symbols-outlined">chat</span>
              <span>Chat</span>
            </button>
            <button class="detail-panel__button detail-panel__button--secondary" (click)="viewPDF(selectedPaper.pdf_url)">
              <span class="material-symbols-outlined">picture_as_pdf</span>
              <span>View PDF</span>
            </button>
            <button class="detail-panel__button detail-panel__button--danger" (click)="deletePaper(selectedPaper.id)">
              <span class="material-symbols-outlined">delete</span>
              <span>Delete</span>
            </button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>